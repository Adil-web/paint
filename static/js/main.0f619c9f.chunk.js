(this["webpackJsonpreact-paint"]=this["webpackJsonpreact-paint"]||[]).push([[0],{40:function(t,e,n){},42:function(t,e,n){},47:function(t,e,n){},48:function(t,e,n){"use strict";n.r(e);var s=n(0),a=n.n(s),o=n(13),i=n.n(o),c=n(9),r=n(10),u=n(15),h=n(14),l=function(){function t(e,n,s){Object(c.a)(this,t),this.canvas=e,this.socket=n,this.id=s,this.ctx=e.getContext("2d"),this.destroyEvents()}return Object(r.a)(t,[{key:"color",set:function(t){this.ctx.strokeStyle=t,this.ctx.fillColor=t,this.ctx.fillStyle=t}},{key:"lineWidth",set:function(t){this.ctx.lineWidth=t}},{key:"destroyEvents",value:function(){this.canvas.onmousemove=null,this.canvas.onmousedown=null,this.canvas.onmouseup=null}}]),t}(),d=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t,s,a){var o;return Object(c.a)(this,n),(o=e.call(this,t,s,a)).listen(),o}return Object(r.a)(n,[{key:"listen",value:function(){this.canvas.onmousemove=this.mouseMoveHandler.bind(this),this.canvas.onmousedown=this.mouseDownHandler.bind(this),this.canvas.onmouseup=this.mouseUpHandler.bind(this)}},{key:"mouseUpHandler",value:function(t){this.mouseDown=!1,this.socket.send(JSON.stringify({method:"draw",id:this.id,figure:{type:"finish"}}))}},{key:"mouseDownHandler",value:function(t){this.mouseDown=!0,this.ctx.beginPath(),console.log(this.ctx),console.log(t),this.ctx.moveTo(t.pageX-t.target.offsetLeft,t.pageY-t.target.offsetTop)}},{key:"mouseMoveHandler",value:function(t){this.mouseDown&&this.socket.send(JSON.stringify({method:"draw",id:this.id,color:this.ctx.strokeStyle,figure:{type:"brush",x:t.pageX-t.target.offsetLeft,y:t.pageY-t.target.offsetTop}}))}}],[{key:"draw",value:function(t,e,n){t.strokeStyle="#ffffff"===t.strokeStyle?"#000000":t.strokeStyle,t.lineTo(e,n),t.stroke()}}]),n}(l),f=n(7),v=new(function(){function t(){Object(c.a)(this,t),this.canvas=null,this.socket=null,this.sessionID=null,this.undoList=[],this.redoList=[],this.username="",Object(f.d)(this)}return Object(r.a)(t,[{key:"setSocket",value:function(t){this.socket=t}},{key:"setID",value:function(t){this.sessionID=t}},{key:"setUsername",value:function(t){this.username=t}},{key:"setCanvas",value:function(t){this.canvas=t}},{key:"pushToUndo",value:function(t){this.undoList.push(t)}},{key:"pushToRedo",value:function(t){this.redoList.push(t)}},{key:"undo",value:function(){var t=this,e=this.canvas.getContext("2d");if(this.undoList.length>1){var n=this.undoList.pop();this.redoList.push(this.canvas.toDataURL());var s=new Image;s.src=n,s.onload=function(){e.clearRect(0,0,t.canvas.width,t.canvas.height),e.drawImage(s,0,0,t.canvas.width,t.canvas.height)}}else e.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"redo",value:function(){var t=this,e=this.canvas.getContext("2d");if(this.redoList.length>1){var n=this.redoList.pop();this.undoList.push(this.canvas.toDataURL());var s=new Image;s.src=n,s.onload=function(){e.clearRect(0,0,t.canvas.width,t.canvas.height),e.drawImage(s,0,0,t.canvas.width,t.canvas.height)}}}}]),t}()),b=new(function(){function t(){Object(c.a)(this,t),this.tool=null,Object(f.d)(this)}return Object(r.a)(t,[{key:"setTool",value:function(t){this.tool=t}},{key:"setColor",value:function(t){this.tool.color=t}},{key:"setLineWidth",value:function(t){this.tool.lineWidth=t}}]),t}()),m=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var s;return Object(c.a)(this,n),(s=e.call(this,t)).listen(),s}return Object(r.a)(n,[{key:"listen",value:function(){this.canvas.onmousemove=this.mouseMoveHandler.bind(this),this.canvas.onmousedown=this.mouseDownHandler.bind(this),this.canvas.onmouseup=this.mouseUpHandler.bind(this)}},{key:"mouseUpHandler",value:function(t){this.mouseDown=!1}},{key:"mouseDownHandler",value:function(t){this.mouseDown=!0,this.ctx.beginPath(),this.startX=t.pageX-t.target.offsetLeft,this.startY=t.pageY-t.target.offsetTop,this.saved=this.canvas.toDataURL()}},{key:"mouseMoveHandler",value:function(t){if(this.mouseDown){var e=t.pageX-t.target.offsetLeft,n=t.pageY-t.target.offsetTop,s=e-this.startX,a=n-this.startY;this.draw(this.startX,this.startY,s,a)}}},{key:"draw",value:function(t,e,n,s){var a=this,o=new Image;o.src=this.saved,o.onload=function(){a.ctx.clearRect(0,0,a.canvas.width,a.canvas.height),a.ctx.drawImage(o,0,0,a.canvas.width,a.canvas.height),a.ctx.beginPath(),a.ctx.rect(t,e,n,s),a.ctx.fill()}}}]),n}(l),j=(n(40),function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){return Object(c.a)(this,n),e.apply(this,arguments)}return Object(r.a)(n,[{key:"draw",value:function(t,e){this.ctx.strokeStyle="white",this.ctx.lineTo(t,e),this.ctx.stroke()}}]),n}(d)),g=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var s;return Object(c.a)(this,n),(s=e.call(this,t)).listen(),s}return Object(r.a)(n,[{key:"listen",value:function(){this.canvas.onmousemove=this.mouseMoveHandler.bind(this),this.canvas.onmousedown=this.mouseDownHandler.bind(this),this.canvas.onmouseup=this.mouseUpHandler.bind(this)}},{key:"mouseUpHandler",value:function(t){this.mouseDown=!1}},{key:"mouseDownHandler",value:function(t){this.mouseDown=!0,this.ctx.beginPath(),this.startX=t.pageX-t.target.offsetLeft,this.startY=t.pageY-t.target.offsetTop,this.saved=this.canvas.toDataURL()}},{key:"mouseMoveHandler",value:function(t){if(this.mouseDown){var e=t.pageX-t.target.offsetLeft,n=t.pageY-t.target.offsetTop,s=e-this.startX,a=n-this.startY,o=Math.sqrt(Math.pow(s,2)+Math.pow(a,2));this.draw(this.startX,this.startY,o)}}},{key:"draw",value:function(t,e,n){var s=this,a=new Image;a.src=this.saved,a.onload=function(){s.ctx.clearRect(0,0,s.canvas.width,s.canvas.height),s.ctx.drawImage(a,0,0,s.canvas.width,s.canvas.height),s.ctx.beginPath(),s.ctx.arc(t,e,n,0,2*Math.PI),s.ctx.fill()}}}]),n}(l),w=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var s;return Object(c.a)(this,n),(s=e.call(this,t)).listen(),s}return Object(r.a)(n,[{key:"listen",value:function(){this.canvas.onmousemove=this.mouseMoveHandler.bind(this),this.canvas.onmousedown=this.mouseDownHandler.bind(this),this.canvas.onmouseup=this.mouseUpHandler.bind(this)}},{key:"mouseUpHandler",value:function(t){this.mouseDown=!1}},{key:"mouseDownHandler",value:function(t){this.mouseDown=!0,this.ctx.beginPath(),this.ctx.moveTo(t.pageX-t.target.offsetLeft,t.pageY-t.target.offsetTop),this.startX=t.pageX-t.target.offsetLeft,this.startY=t.pageY-t.target.offsetTop,this.saved=this.canvas.toDataURL()}},{key:"mouseMoveHandler",value:function(t){this.mouseDown&&this.draw(t.pageX-t.target.offsetLeft,t.pageY-t.target.offsetTop)}},{key:"draw",value:function(t,e){var n=this,s=new Image;s.src=this.saved,s.onload=function(){n.ctx.clearRect(0,0,n.canvas.width,n.canvas.height),n.ctx.drawImage(s,0,0,n.canvas.width,n.canvas.height),n.ctx.beginPath(),n.ctx.moveTo(n.startX,n.startY),n.ctx.lineTo(t,e),n.ctx.stroke()}}}]),n}(l),p=n(1);var O=function(){return Object(p.jsxs)("div",{className:"toolbar",children:[Object(p.jsx)("button",{className:"toolbar__btn",name:"pencil",onClick:function(){return b.setTool(new d(v.canvas))},children:"\u270e"}),Object(p.jsx)("button",{className:"toolbar__btn",name:"rectangle",onClick:function(){return b.setTool(new m(v.canvas))},children:"\u25ad"}),Object(p.jsx)("button",{className:"toolbar__btn",name:"circle",onClick:function(){return b.setTool(new g(v.canvas))},children:"\u25ef"}),Object(p.jsx)("button",{className:"toolbar__btn",name:"line",onClick:function(){return b.setTool(new w(v.canvas))},children:"\u2571"}),Object(p.jsx)("button",{className:"toolbar__btn",name:"eraser",onClick:function(){return b.setTool(new j(v.canvas))},children:"\u26eb"}),Object(p.jsx)("input",{type:"color",name:"colors",defaultValue:"#000000",onChange:function(t){return b.setColor(t.target.value)}}),Object(p.jsx)("button",{className:"toolbar__btn",name:"undo",style:{marginLeft:"auto"},onClick:function(){return v.undo()},children:"\u21a9"}),Object(p.jsx)("button",{className:"toolbar__btn",name:"redo",onClick:function(){return v.redo()},children:"\u21aa"}),Object(p.jsx)("button",{className:"toolbar__btn",name:"save",children:"\ud83d\udcbe"})]})},x=n(22);var k=function(){var t=Object(s.useState)(1),e=Object(x.a)(t,2),n=e[0],a=e[1];return Object(p.jsxs)("div",{className:"setting-bar",children:[Object(p.jsxs)("label",{htmlFor:"line-width",children:["\u0422\u043e\u043b\u0449\u0438\u043d\u0430 \u043b\u0438\u043d\u0438\u0438: ",n]}),Object(p.jsx)("input",{id:"line-width",type:"range",defaultValue:1,min:1,max:50,style:{margin:"0 10px"},onChange:function(t){return function(t){b.setLineWidth(t.target.value),a(t.target.value)}(t)}})]})},y=n(35),D=n(51),L=n(52),H=(n(42),n(4));var T=Object(y.a)((function(){var t=Object(s.useRef)(),e=Object(s.useRef)(),n=Object(s.useState)(!0),a=Object(x.a)(n,2),o=a[0],i=a[1],c=Object(H.g)();return Object(s.useEffect)((function(){v.setCanvas(t.current)}),[]),Object(s.useEffect)((function(){if(e.current.value){var n=new WebSocket("ws://web-socks123.herokuapp.com/");v.setID(c.id),v.setSocket(n),b.setTool(new d(t.current,n,c.id)),n.onopen=function(){n.send(JSON.stringify({id:c.id,username:v.username,method:"connection"})),console.log("connected")},n.onmessage=function(e){var n=JSON.parse(e.data);switch(console.log(n),n.method){case"connection":console.log("User ".concat(n.username," is connected!"));break;case"draw":!function(e){var n=e.figure,s=t.current.getContext("2d");switch(n.type){case"brush":d.draw(s,n.x,n.y),b.setColor(n.color);break;case"finish":s.beginPath()}}(n)}}}}),[v.username]),Object(p.jsxs)("div",{className:"canvas",children:[Object(p.jsxs)(D.a,{show:o,onHide:function(){},children:[Object(p.jsx)(D.a.Header,{closeButton:!0,children:Object(p.jsx)(D.a.Title,{children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0435 \u0438\u043c\u044f:"})}),Object(p.jsx)(D.a.Body,{children:Object(p.jsx)("input",{type:"text",ref:e})}),Object(p.jsx)(D.a.Footer,{children:Object(p.jsx)(L.a,{variant:"primary",onClick:function(){return v.setUsername(e.current.value),console.log(v.username),void i(!1)},children:"\u0412\u043e\u0439\u0442\u0438"})})]}),Object(p.jsx)("canvas",{onMouseDown:function(){v.pushToUndo(t.current.toDataURL())},ref:t,width:1e3,height:500})]})})),C=n(34);n(47);var U=function(){return Object(p.jsx)(C.a,{children:Object(p.jsx)("div",{className:"app",children:Object(p.jsxs)(H.d,{children:[Object(p.jsxs)(H.b,{path:"/:id",children:[Object(p.jsx)(O,{}),Object(p.jsx)(k,{}),Object(p.jsx)(T,{})]}),Object(p.jsx)(H.a,{to:"".concat((+new Date).toString(16))})]})})})};i.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(U,{})}),document.getElementById("root"))}},[[48,1,2]]]);
//# sourceMappingURL=main.0f619c9f.chunk.js.map